<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Button - Simditor</title>
	<meta name="viewport" content="width=device-width">

	<link media="all" rel="stylesheet" type="text/css" href="../assets/styles/app.css" />
	<link media="all" rel="stylesheet" type="text/css" href="../assets/styles/font-awesome.css" />
	<link media="all" rel="stylesheet" type="text/css" href="../assets/styles/simditor.css" />

	<script type="text/javascript" src="../assets/scripts/jquery-2.1.0.min.js"></script>
</head>
<body>

<div class="wrapper">
	
<header>
	<h1>Simditor</h1>
	<p class="desc">简单快速的富文本编辑器</p>
</header>
<nav>
	<a href="../.">Demo</a>
	<a href="../tours/tour-usage.html">教程</a>
	<a href="../docs/doc-config.html" class="active">文档</a>
	<a href="../download.html">下载</a>
</nav>

	<section class="page-doc page-sidebar" id="page-doc-button">
	<aside>
	<ul>
		<li><a href="../docs/doc-config.html">配置</a></li>
		<li><a href="../docs/doc-method.html">方法</a></li>
		<li><a href="../docs/doc-event.html">事件</a></li>
		<li class="active"><a href="../docs/doc-button.html">Button</a></li>
	</ul>
</aside>



	<article class="editor-style">
		<p>Simditor 的按钮都继承自 <a href="https://github.com/mycolorway/simditor/blob/master/src/buttons/button.coffee">Button 类</a>，并且需要通过 <code>Simditor.Toolbar.addButton(Button)</code> 方法来注册，例如：</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">TitleButton</span> <span class="k">extends</span> <span class="nx">SimditorButton</span>
  <span class="nv">name: </span><span class="s">&#39;title&#39;</span>
  <span class="nv">title: </span><span class="s">&#39;标题文字&#39;</span>
  <span class="p">...</span>

  <span class="nv">setActive: </span><span class="nf">(active) -&gt;</span>
    <span class="p">...</span>

  <span class="nv">setDisabled: </span><span class="nf">(disabled) -&gt;</span>
    <span class="p">...</span>

  <span class="nv">status: </span><span class="nf">($node) -&gt;</span>
    <span class="p">...</span>

  <span class="nv">command: </span><span class="nf">(param) -&gt;</span>
    <span class="c1"># 在 Button 类中这是一个抽象方法，需要各个按钮单独实现</span>
    <span class="c1"># 执行格式化的操作</span>

<span class="nx">Simditor</span><span class="p">.</span><span class="nx">Toolbar</span><span class="p">.</span><span class="nx">addButton</span><span class="p">(</span><span class="nx">TitleButton</span><span class="p">)</span>
</code></pre></div>
<h3>属性</h3>

<dl class="doc-button-properties">
  
    <dt id="anchor-name">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">name</span>
      <span class="type">String</span>
      <span class="default">默认值: ''</span>
    </dt>
    <dd class="expand">
      <p>该按钮组件的名称，会在按钮的 DOM 元素上增加相应的 class <code>.toolbar-item-[name]</code>，并且会用于在 Toolbar 注册，初始化编辑器时，可以在 <a href="../docs/doc-config.html#anchor-toolbar">toolbar</a> 中配置初始化按钮组件，所以此名称应该区别于其他按钮。</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">HelloButton</span> <span class="k">extends</span> <span class="nx">SimditorButton</span>
  <span class="nv">name: </span><span class="s">&#39;hello&#39;</span>

<span class="nv">editor = </span><span class="k">new</span> <span class="nx">Simditor</span>
  <span class="nv">toolbar: </span><span class="p">[</span><span class="s">&#39;hello&#39;</span><span class="p">]</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-icon">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">icon</span>
      <span class="type">String</span>
      <span class="default">默认值: ''</span>
    </dt>
    <dd class="expand">
      <p>按钮显示的图标，Simditor 使用 <a href="http://fontawesome.io/">Font Awesome</a> 来渲染按钮图标，将会使用 <code>fa-[icon]</code> 作为按钮的图标，如果该属性为空则显示按钮的 <strong>text</strong> 属性。</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="c1"># 按钮图标为 .fa-bell</span>
<span class="k">class</span> <span class="nx">HelloButton</span> <span class="k">extends</span> <span class="nx">SimditorButton</span>
  <span class="nv">name: </span><span class="s">&#39;hello&#39;</span>
  <span class="nv">icon: </span><span class="s">&#39;bell&#39;</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-title">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">title</span>
      <span class="type">String</span>
      <span class="default">默认值: ''</span>
    </dt>
    <dd class="expand">
      <p>按钮 DOM 元素的 title 属性，鼠标 hover 的时候显示。</p>

    </dd>
  
    <dt id="anchor-text">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">text</span>
      <span class="type">String</span>
      <span class="default">默认值: ''</span>
    </dt>
    <dd class="expand">
      <p>非图标按钮，用此 <strong>text</strong> 作文字按钮。</p>

    </dd>
  
    <dt id="anchor-htmlTag">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">htmlTag</span>
      <span class="type">String</span>
      <span class="default">默认值: ''</span>
    </dt>
    <dd class="expand">
      <p>单个或多个由逗号分隔的 HTML 标签名称，表示按钮会在编辑器中插入的 HTML 标签，可用于 <a href="#anchor-status">status</a> 方法中识别按钮的激活状态。</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">TitleButton</span> <span class="k">extends</span> <span class="nx">SimditorButton</span>
  <span class="nv">name: </span><span class="s">&#39;title&#39;</span>
  <span class="nv">title: </span><span class="s">&#39;标题文字&#39;</span>
  <span class="nv">htmlTag: </span><span class="s">&#39;h1, h2, h3, h4&#39;</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-disableTag">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">disableTag</span>
      <span class="type">String</span>
      <span class="default">默认值: ''</span>
    </dt>
    <dd class="expand">
      <p>单个或多个由逗号分隔的 HTML 标签名称，当光标在这些元素中时，按钮会被禁用，比如在代码和表格中不能使用标题按钮。</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">TitleButton</span> <span class="k">extends</span> <span class="nx">SimditorButton</span>
  <span class="nv">name: </span><span class="s">&#39;title&#39;</span>
  <span class="nv">title: </span><span class="s">&#39;标题文字&#39;</span>
  <span class="nv">htmlTag: </span><span class="s">&#39;h1, h2, h3, h4&#39;</span>
  <span class="nv">disableTag: </span><span class="s">&#39;pre, table&#39;</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-menu">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">menu</span>
      <span class="type">Boolean / Array</span>
      <span class="default">默认值: false</span>
    </dt>
    <dd class="expand">
      <p>配置该属性，按钮会成为菜单按钮。</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">TitleButton</span> <span class="k">extends</span> <span class="nx">SimditorButton</span>
  <span class="nv">name: </span><span class="s">&#39;title&#39;</span>
  <span class="nv">title: </span><span class="s">&#39;标题文字&#39;</span>
  <span class="nv">htmlTag: </span><span class="s">&#39;h1&#39;</span>
  <span class="nv">disableTag: </span><span class="s">&#39;pre, table&#39;</span>
  <span class="nv">menu: </span><span class="p">[{</span>
    <span class="nv">name: </span><span class="s">&#39;normal&#39;</span>
    <span class="nv">title: </span><span class="s">&#39;普通文本&#39;</span>
    <span class="nv">text: </span><span class="s">&#39;普通文本&#39;</span>
    <span class="nv">param: </span><span class="s">&#39;p&#39;</span>
  <span class="p">},</span> <span class="s">&#39;|&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nv">name: </span><span class="s">&#39;h1&#39;</span><span class="p">,</span>
    <span class="nv">title: </span><span class="s">&#39;标题 1&#39;</span>
    <span class="nv">text: </span><span class="s">&#39;标题 1&#39;</span>
    <span class="nv">param: </span><span class="s">&#39;h1&#39;</span>
  <span class="p">}]</span>
</code></pre></div>
<p><strong>menu</strong> 数组中可能是对象或者字符串 <code>&#39;|&#39;</code>，后者表示菜单中的分隔线，如果是对象，则有四个属性：<code>name</code><code>title</code><code>text</code><code>param</code>，name 用于增加对应的 class，text 和 title 的作用和按钮的属性类似，param 会作为参数传给方法 <a href="#anchor-command">command</a>。</p>

    </dd>
  
    <dt id="anchor-active">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">active</span>
      <span class="type">Boolean</span>
      <span class="default">默认值: false</span>
    </dt>
    <dd class="expand">
      <p>按钮是否处于激活状态。只读，请使用 <a href="#anchor-setActive">setActive</a> 方法来设置按钮的激活状态。</p>

    </dd>
  
    <dt id="anchor-disabled">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">disabled</span>
      <span class="type">Boolean</span>
      <span class="default">默认值: false</span>
    </dt>
    <dd class="expand">
      <p>按钮是否处于禁用状态。只读，请使用 <a href="#anchor-setActive">setDisabled</a> 方法来设置按钮的激活状态。</p>

    </dd>
  
    <dt id="anchor-needFocus">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">needFocus</span>
      <span class="type">Boolean</span>
      <span class="default">默认值: true</span>
    </dt>
    <dd class="expand">
      <p>如果为 <code>true</code> 则表示该按钮必须在鼠标 focus 到编辑器的状态才有效。</p>

    </dd>
  
    <dt id="anchor-shortcut">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">shortcut</span>
      <span class="type">null / String</span>
      <span class="default">默认值: null</span>
    </dt>
    <dd class="expand">
      <p>为按钮设置快捷键，结构为功能键和按键的编码用加号连接，比如 <code>&#39;cmd+99&#39;</code>，支持的功能键为 <code>cmd</code><code>shift</code><code>alt</code><code>ctrl</code></p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">BoldButton</span> <span class="k">extends</span> <span class="nx">Button</span>
  <span class="nv">name: </span><span class="s">&#39;bold&#39;</span>
  <span class="nv">title: </span><span class="s">&#39;加粗文字&#39;</span>

  <span class="p">...</span>

  <span class="c1"># cmd + b 会对选中文字加粗</span>
  <span class="nv">shortcut: </span><span class="s">&#39;cmd+66&#39;</span>
</code></pre></div>
    </dd>
  
</dl>

<h3>方法</h3>

<dl class="doc-button-methods">
  
    <dt id="anchor-setActive">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">setActive</span>
      <span class="params">
        
          <span class="param">
            <span class="param-name">active</span>
            <span class="param-type">Boolean</span>
          </span>
        
      </span>
    </dt>
    <dd class="expand">
      <p>根据参数设置按钮的激活状态，Button 类做了基本的实现，包括设置 active 属性和按钮样式。
当编辑器 blur 的时候该方法会被触发</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="nv">setActive: </span><span class="nf">(active) -&gt;</span>
  <span class="vi">@active = </span><span class="nx">active</span>
  <span class="nx">@el</span><span class="p">.</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s">&#39;active&#39;</span><span class="p">,</span> <span class="nx">@active</span><span class="p">)</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-setDisabled">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">setDisabled</span>
      <span class="params">
        
          <span class="param">
            <span class="param-name">disabled</span>
            <span class="param-type">Boolean</span>
          </span>
        
      </span>
    </dt>
    <dd class="expand">
      <p>根据参数设置按钮的是否禁用，Button 类做了基本的实现，包括设置 disabled 属性和按钮样式
当编辑器 blur 的时候该方法会被触发</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="nv">setDisabled: </span><span class="nf">(disabled) -&gt;</span>
  <span class="vi">@disabled = </span><span class="nx">disabled</span>
  <span class="nx">@el</span><span class="p">.</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s">&#39;disabled&#39;</span><span class="p">,</span> <span class="nx">@disabled</span><span class="p">)</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-status">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">status</span>
      <span class="params">
        
          <span class="param">
            <span class="param-name">$node</span>
            <span class="param-type">jQuery Object</span>
          </span>
        
      </span>
    </dt>
    <dd class="expand">
      <p>该方法在编辑器 <a href="../docs/doc-event.html#anchor-selectionchanged">selectionchanged</a> 和 <a href="../docs/doc-event.html#anchor-focus">focus</a> 发生时，在 Toolbar 类中被多次调用，去更新按钮的状态。</p>

<p>参数 $node 是光标所在位置冒泡遍历所有的父元素直到编辑区域的最外层 DOM，也就是 editor.body，但不包括它。</p>

<p>所以可以根据参数 $node 和属性 htmlTag disableTag 来更新按钮状态。</p>

<p>下面是 Button 类的基本实现</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="nv">status: </span><span class="nf">($node) -&gt;</span>
  <span class="nx">@setDisabled</span> <span class="nx">$node</span><span class="p">.</span><span class="o">is</span><span class="p">(</span><span class="nx">@disableTag</span><span class="p">)</span> <span class="k">if</span> <span class="nx">$node</span><span class="o">?</span>
  <span class="k">return</span> <span class="kc">true</span> <span class="k">if</span> <span class="nx">@disabled</span>

  <span class="nx">@setActive</span> <span class="nx">$node</span><span class="p">.</span><span class="o">is</span><span class="p">(</span><span class="nx">@htmlTag</span><span class="p">)</span> <span class="k">if</span> <span class="nx">$node</span><span class="o">?</span>
  <span class="nx">@active</span>
</code></pre></div>
    </dd>
  
    <dt id="anchor-command">
      <!--<span class="icon fa fa-caret-down"></span>-->
      <span class="name">command</span>
      <span class="params">
        
          <span class="param">
            <span class="param-name">param</span>
            <span class="param-type">any</span>
          </span>
        
      </span>
    </dt>
    <dd class="expand">
      <p>点击按钮会执行的操作，通常是修改编辑的内容。在 Button 类中这是一个抽象方法，需要各按钮组件自己实现。</p>

<p>如果是菜单按钮，则参数 param 会是 <a href="#anchor-menu">menu</a> 配置中的 param</p>
<div class="highlight"><pre><code class="coffee language-coffee" data-lang="coffee"><span class="k">class</span> <span class="nx">BoldButton</span> <span class="k">extends</span> <span class="nx">Button</span>
  <span class="p">...</span>

  <span class="nv">command: </span><span class="nf">-&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span> <span class="s">&#39;bold&#39;</span>
    <span class="nx">@editor</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&#39;valuechanged&#39;</span>
    <span class="nx">@editor</span><span class="p">.</span><span class="nx">trigger</span> <span class="s">&#39;selectionchanged&#39;</span>
</code></pre></div>
<p>需要注意的是，如果内容改变了，需要手动触发编辑器的 valuechanged 和 selectionchanged 事件。</p>

    </dd>
  
</dl>

	</article>
</section>

<script type="text/javascript" src="../assets/scripts/page-doc.js"></script>

	
<footer>
	&copy; <a href="http://tower.im">彩程设计</a>
</footer>

</div>

</body>
</html>

